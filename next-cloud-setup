# üöÄ **–ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Nextcloud –≤ Podman —Å Nginx –∏ MariaDB**
–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç **—É—Å—Ç–∞–Ω–æ–≤–∫—É Nextcloud** –≤ **Podman**, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **MariaDB, Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)** –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É **Nginx + HTTPS**.  
üìå **–í—Å–µ –¥–∞–Ω–Ω—ã–µ Nextcloud –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ `/nextcloud/`** –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## üìå **1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã**
### üîπ **–û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Podman**
```sh
sudo apt update && sudo apt upgrade -y
sudo apt install podman -y
```

### üîπ **–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**
```sh
sudo mkdir -p /nextcloud/data /nextcloud/db /nextcloud/config /nextcloud/redis
sudo chown -R 1000:1000 /nextcloud
sudo chmod -R 755 /nextcloud
```

### üîπ **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Å–µ—Ç—å Podman**
```sh
podman network create nextcloud-net
```

---

## üìå **2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö MariaDB**
### **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä MariaDB**
```sh
podman run -d --name nextcloud-db \
  --network nextcloud-net \
  -e MYSQL_ROOT_PASSWORD=rootpass \
  -e MYSQL_DATABASE=nextcloud \
  -e MYSQL_USER=nextcloud \
  -e MYSQL_PASSWORD=securepass \
  -v /nextcloud/db:/var/lib/mysql \
  docker.io/library/mariadb:10.6
```
üìå **–ü–æ—è—Å–Ω–µ–Ω–∏–µ**:
- `MYSQL_ROOT_PASSWORD=rootpass` ‚Äì –ø–∞—Ä–æ–ª—å root MariaDB.
- `MYSQL_DATABASE=nextcloud` ‚Äì —Å–æ–∑–¥–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.
- `MYSQL_USER=nextcloud`, `MYSQL_PASSWORD=securepass` ‚Äì —Å–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è Nextcloud.
- `-v /nextcloud/db:/var/lib/mysql` ‚Äì —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

---

## üìå **3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nextcloud**
```sh
podman run -d --name nextcloud \
  --network nextcloud-net \
  -e MYSQL_HOST=nextcloud-db \
  -e MYSQL_DATABASE=nextcloud \
  -e MYSQL_USER=nextcloud \
  -e MYSQL_PASSWORD=securepass \
  -v /nextcloud/data:/var/www/html \
  -v /nextcloud/config:/var/www/html/config \
  -p 8080:80 \
  docker.io/library/nextcloud:latest
```
üìå **–ü–æ—è—Å–Ω–µ–Ω–∏–µ**:
- Nextcloud –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ **MariaDB** –ø–æ —Å–µ—Ç–∏ `nextcloud-net`.
- –î–∞–Ω–Ω—ã–µ Nextcloud —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `/nextcloud/data` –∏ `/nextcloud/config`.
- Nextcloud —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **–ø–æ—Ä—Ç—É 8080**.

---

## üìå **4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è)**
```sh
podman run -d --name nextcloud-redis \
  --network nextcloud-net \
  -v /nextcloud/redis:/data \
  docker.io/library/redis
```
üìå **–î–æ–±–∞–≤—å—Ç–µ Redis –≤ –∫–æ–Ω—Ñ–∏–≥ Nextcloud (`config.php`)**:
```php
'memcache.local' => '\OC\Memcache\Redis',
'redis' => [
    'host' => 'nextcloud-redis',
    'port' => 6379,
    'timeout' => 0.0,
],
```

---

## üìå **5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –∫–∞–∫ Reverse Proxy**
### **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx**
```sh
sudo apt install nginx -y
```

### **–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nextcloud**
```sh
sudo nano /etc/nginx/conf.d/nextcloud.conf
```
–î–æ–±–∞–≤—å—Ç–µ:
```nginx
server {
    listen 80;
    server_name your.domain.com;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    client_max_body_size 512M;
    location ~ /.well-known {
        allow all;
    }
}
```
üìå **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:**
```sh
sudo systemctl restart nginx
```
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```sh
sudo nginx -t
```
‚úÖ **–ï—Å–ª–∏ "syntax is ok", –∑–Ω–∞—á–∏—Ç –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.**

---

## üìå **6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS (–µ—Å–ª–∏ Let's Encrypt —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)**
### **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**
–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx:
```sh
sudo nano /etc/nginx/conf.d/nextcloud.conf
```
–ò–∑–º–µ–Ω–∏—Ç–µ –µ–µ —Ç–∞–∫, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å HTTPS:
```nginx
server {
    listen 80;
    server_name your.domain.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your.domain.com;

    ssl_certificate /etc/letsencrypt/live/your.domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your.domain.com/privkey.pem;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto https;
    }

    client_max_body_size 512M;
    location ~ /.well-known {
        allow all;
    }
}
```
üìå **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:**
```sh
sudo systemctl restart nginx
```

---

## üìå **7. –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**
–ß—Ç–æ–±—ã Nextcloud, MariaDB –∏ Redis –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:
```sh
podman generate systemd --name nextcloud-db > ~/.config/systemd/user/nextcloud-db.service
podman generate systemd --name nextcloud > ~/.config/systemd/user/nextcloud.service
podman generate systemd --name nextcloud-redis > ~/.config/systemd/user/nextcloud-redis.service

systemctl --user enable nextcloud-db.service
systemctl --user enable nextcloud.service
systemctl --user enable nextcloud-redis.service
```

---

## üìå **8. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**
1Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞:
   ```
   https://your.domain.com
   ```
   –∏–ª–∏
   ```
   http://your-vps-ip
   ```

2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ **(–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å)**.

3Ô∏è‚É£ –ì–æ—Ç–æ–≤–æ! üöÄ –¢–µ–ø–µ—Ä—å Nextcloud –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω!

---

## üî• **–ò—Ç–æ–≥**
‚úÖ **Nextcloud –∑–∞–ø—É—â–µ–Ω –≤ Podman**  
‚úÖ **MariaDB –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**  
‚úÖ **Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**  
‚úÖ **Nginx —Å HTTPS –∫–∞–∫ Reverse Proxy**  
‚úÖ **–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `/nextcloud/`**  
‚úÖ **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**  

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å **Nextcloud —Å –ø–æ–ª–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é**!  
–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî —Å–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ! üöÄüî•
